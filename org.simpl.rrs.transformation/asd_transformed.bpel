<?xml version="1.0" encoding="UTF-8"?>
<!-- asd BPEL Process [Generated by the Eclipse BPEL Designer] -->
<bpel:process xmlns:bpel="http://docs.oasis-open.org/wsbpel/2.0/process/executable" xmlns:tns="http://eclipse.org/bpel/sample" xmlns:ns1="http://www.w3.org/2001/XMLSchema" xmlns:rrsWSDL="simpl" xmlns:rrs="http://uni-stuttgart.de/simpl/rrs" name="asd" targetNamespace="http://eclipse.org/bpel/sample" suppressJoinFailure="yes">
  <!-- Import the client WSDL -->
  <bpel:import location="rrs.xsd" namespace="http://uni-stuttgart.de/simpl/rrs" importType="http://www.w3.org/2001/XMLSchema" />
  <bpel:import location="asdArtifacts.wsdl" namespace="http://eclipse.org/bpel/sample" importType="http://schemas.xmlsoap.org/wsdl/" />
  <!-- ================================================================= -->
  <!-- PARTNERLINKS                                                      -->
  <!-- List of services participating in this BPEL process               -->
  <!-- ================================================================= -->
  <bpel:partnerLinks>
    <!-- The 'client' role represents the requester of this service. -->
    <bpel:partnerLink name="client" partnerLinkType="tns:asd" myRole="asdProvider" />
    <bpel:partnerLink name="RRS_Retrieval" partnerLinkType="tns:RRSGetType" myRole="get" />
    <bpel:partnerLink name="RRS_MetaData" partnerLinkType="tns:RRSMetaType" myRole="getEPR" />
  </bpel:partnerLinks>
  <!-- ================================================================= -->
  <!-- VARIABLES                                                         -->
  <!-- List of messages and XML documents used within this BPEL process  -->
  <!-- ================================================================= -->
  <bpel:variables>
    <!-- Reference to the message passed as input during initiation -->
    <bpel:variable name="input" messageType="tns:asdRequestMessage" />
    <!-- 
          Reference to the message that will be returned to the requester
          -->
    <bpel:variable name="output" messageType="tns:asdResponseMessage" />
    <bpel:variable name="data" type="ns1:string" />
    <bpel:variable name="dataEPR" type="rrs:EPR" />
    <bpel:variable name="on" type="ns1:boolean" />
    <bpel:variable name="onEPR" type="rrs:EPR" />
    <bpel:variable name="dataEPR_Name" type="ns1:string" />
    <bpel:variable name="onEPR_Name" type="ns1:string" />
  </bpel:variables>
  <!-- ================================================================= -->
  <!-- ORCHESTRATION LOGIC                                               -->
  <!-- Set of activities coordinating the flow of messages across the    -->
  <!-- services integrated within this business process                  -->
  <!-- ================================================================= -->
  <bpel:sequence name="main">
    <!-- Receive input from requester. 
             Note: This maps to operation defined in asd.wsdl 
             -->
    <bpel:receive name="receiveInput" partnerLink="client" portType="tns:asd" operation="process" variable="input" createInstance="yes" />
    <bpel:sequence name="prepare">
      <bpel:assign>
        <bpel:copy>
          <bpel:from>
            <bpel:literal xml:space="preserve">data</bpel:literal>
          </bpel:from>
          <bpel:to variable="dataEPR_Name" />
        </bpel:copy>
        <bpel:copy>
          <bpel:from>
            <bpel:literal xml:space="preserve">on</bpel:literal>
          </bpel:from>
          <bpel:to variable="onEPR_Name" />
        </bpel:copy>
      </bpel:assign>
      <bpel:invoke name="init_onEPR" partnerLink="RRS_MetaData" operation="getEPR" portType="rrsWSDL:RRSMetaDataService" inputVariable="onEPR_Name" outputVariable="onEPR" />
      <bpel:invoke name="init_dataEPR" partnerLink="RRS_MetaData" operation="getEPR" portType="rrsWSDL:RRSMetaDataService" inputVariable="dataEPR_Name" outputVariable="dataEPR" />
    </bpel:sequence>
    <!-- Generate reply to synchronous request -->
    <bpel:invoke name="dataRefresh_0" partnerLink="RRS_Retrieval" operation="get" portType="rrsWSDL:RRSRetrievalService" inputVariable="dataEPR" outputVariable="data" />
    <bpel:assign validate="no" name="Assign">
      <bpel:copy>
        <bpel:from>
          <bpel:literal xml:space="preserve"><tns:asdResponse xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <tns:result>test</tns:result>
</tns:asdResponse>
</bpel:literal>
        </bpel:from>
        <bpel:to variable="output" part="payload" />
      </bpel:copy>
      <bpel:copy>
        <bpel:from variable="data" />
        <bpel:to part="payload" variable="output" />
      </bpel:copy>
    </bpel:assign>
    <bpel:assign validate="no" name="asd">
      <bpel:copy>
        <bpel:from variable="onEPR" />
        <bpel:to variable="in" />
      </bpel:copy>
    </bpel:assign>
    <bpel:reply name="replyOutput" partnerLink="client" portType="tns:asd" operation="process" variable="onEPR" />
  </bpel:sequence>
</bpel:process>

